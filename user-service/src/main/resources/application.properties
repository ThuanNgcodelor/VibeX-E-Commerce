server.port=8002
spring.application.name=user-service
application-title=User Service
springdoc.swagger-ui.path=/swagger-ui.html
spring.config.import=configserver:http://localhost:8888/

# ============================================
# Database Connection Pool (HikariCP)
# ============================================
# S? l??ng k?t n?i t?i ?a (Max connections) trong b? ch?a (pool)
# 25 là con s? phù h?p cho User Service (n?i ch? y?u x? lý login, xem profile...)
spring.datasource.hikari.maximum-pool-size=25

# S? l??ng k?t n?i t?i thi?u luôn ???c gi? ? tr?ng thái r?nh (idle)
# Gi? s?n 5 k?t n?i ?? khi có request m?i là dùng ???c ngay, không c?n kh?i t?o l?i
spring.datasource.hikari.minimum-idle=5

# Th?i gian t?i ?a ch? ?? l?y ???c m?t k?t n?i t? pool (30 giây)
# N?u sau 30s mà không l?y ???c k?t n?i nào (do pool b? full), s? báo l?i Exception
spring.datasource.hikari.connection-timeout=30000

# Th?i gian t?i ?a m?t k?t n?i ???c phép n?m r?nh (10 phút)
# N?u quá 10 phút không ai dùng, k?t n?i này s? b? ?óng ?? ti?t ki?m tài nguyên
spring.datasource.hikari.idle-timeout=600000

# Tu?i th? t?i ?a c?a m?t k?t n?i (30 phút)
# Dù ?ang dùng hay không, sau 30 phút k?t n?i s? b? thay m?i ?? tránh l?i ti?m ?n t? phía DB
spring.datasource.hikari.max-lifetime=1800000

# Ng??ng th?i gian ?? phát hi?n rò r? k?t n?i (Leak Detection - 60 giây)
# N?u code m??n k?t n?i quá 1 phút mà ch?a tr?, h? th?ng s? log c?nh báo (d?u hi?u code l?i)
spring.datasource.hikari.leak-detection-threshold=60000

# Câu l?nh SQL ??n gi?n ?? ki?m tra k?t n?i còn s?ng hay không
# SELECT 1 là câu l?nh nh? nh?t, nhanh nh?t ?? ping Database
spring.datasource.hikari.connection-test-query=SELECT 1

# ??t tên cho Pool ?? d? dàng nh?n bi?t khi xem log ho?c debug
spring.datasource.hikari.pool-name=UserServiceHikariPool

# ============================================
# ? T?I ?U: Tomcat Thread Pool (Web Server)
# ============================================
# S? l??ng lu?ng (Thread) t?i ?a ?? x? lý HTTP requests ??ng th?i
# 300 threads giúp service ch?u ???c t?i trung bình khá (Medium Traffic)
server.tomcat.threads.max=300

# S? l??ng lu?ng t?i thi?u luôn ???c nuôi s?n
# Gi? 30 lu?ng ch? ?? ph?n h?i ngay l?p t?c khi có khách vào
server.tomcat.threads.min-spare=30

# ?? dài hàng ??i (Queue) khi t?t c? các lu?ng ??u b?n
# N?u 300 threads ??u ?ang làm vi?c, 500 request ti?p theo s? ???c x?p hàng ch?
server.tomcat.accept-count=500

# T?ng s? l??ng k?t n?i TCP t?i ?a mà Server ch?p nh?n
# 5000 connections (bao g?m c? connections ?ang x? lý và ?ang ch? keep-alive)
server.tomcat.max-connections=5000

# Th?i gian ch? c?a m?t k?t n?i (20 giây)
# N?u client k?t n?i mà không g?i request trong 20s, server s? ng?t k?t n?i
server.tomcat.connection-timeout=20000

# B?t tính n?ng nén d? li?u ph?n h?i (Response Compression)
# Giúp gi?m dung l??ng file g?i ?i, t?ng t?c ?? t?i cho ng??i dùng
server.compression.enabled=true

# ??nh ngh?a các lo?i file (MIME types) s? ???c nén
# Nén HTML, XML, Text, CSS, JS, JSON
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json

# Kích th??c t?i thi?u ?? th?c hi?n nén (1KB)
# Ch? nén n?u d? li?u l?n h?n 1024 bytes (nh? quá nén s? t?n CPU mà không hi?u qu?)
server.compression.min-response-size=1024

# ============================================
# ? T?I ?U: Spring Boot Actuator (Monitoring)
# ============================================
# M? các c?ng (endpoints) giám sát c?n thi?t
# health (s?c kh?e), metrics (s? li?u), info (thông tin), prometheus (?? v? bi?u ??)
management.endpoints.web.exposure.include=health,metrics,info,prometheus

# Hi?n th? chi ti?t tr?ng thái s?c kh?e
# "always" s? hi?n rõ: Database UP/DOWN, Disk Space còn bao nhiêu...
management.endpoint.health.show-details=always

# B?t tính n?ng xu?t d? li?u cho Prometheus
# T?o endpoint /actuator/prometheus ?? Prometheus server có th? vào l?y d? li?u

# G?n nhãn tên ?ng d?ng vào d? li?u metrics
# Giúp phân bi?t metrics c?a "User Service" v?i các service khác trên Grafana
management.metrics.tags.application=${spring.application.name}