server.port=8002
spring.application.name=user-service
application-title=User Service
springdoc.swagger-ui.path=/swagger-ui.html

spring.config.import=optional:configserver:http://localhost:8888/
# ============================================
# Database Connection Pool (HikariCP)
# ============================================
# S? l??ng k?t n?i t?i ?a (Max connections) trong b? ch?a (pool)
# 25 l� con s? ph� h?p cho User Service (n?i ch? y?u x? l� login, xem profile...)
spring.datasource.hikari.maximum-pool-size=25

# S? l??ng k?t n?i t?i thi?u lu�n ???c gi? ? tr?ng th�i r?nh (idle)
# Gi? s?n 5 k?t n?i ?? khi c� request m?i l� d�ng ???c ngay, kh�ng c?n kh?i t?o l?i
spring.datasource.hikari.minimum-idle=5

# Th?i gian t?i ?a ch? ?? l?y ???c m?t k?t n?i t? pool (30 gi�y)
# N?u sau 30s m� kh�ng l?y ???c k?t n?i n�o (do pool b? full), s? b�o l?i Exception
spring.datasource.hikari.connection-timeout=30000

# Th?i gian t?i ?a m?t k?t n?i ???c ph�p n?m r?nh (10 ph�t)
# N?u qu� 10 ph�t kh�ng ai d�ng, k?t n?i n�y s? b? ?�ng ?? ti?t ki?m t�i nguy�n
spring.datasource.hikari.idle-timeout=600000

# Tu?i th? t?i ?a c?a m?t k?t n?i (30 ph�t)
# D� ?ang d�ng hay kh�ng, sau 30 ph�t k?t n?i s? b? thay m?i ?? tr�nh l?i ti?m ?n t? ph�a DB
spring.datasource.hikari.max-lifetime=1800000

# Ng??ng th?i gian ?? ph�t hi?n r� r? k?t n?i (Leak Detection - 60 gi�y)
# N?u code m??n k?t n?i qu� 1 ph�t m� ch?a tr?, h? th?ng s? log c?nh b�o (d?u hi?u code l?i)
spring.datasource.hikari.leak-detection-threshold=60000

# C�u l?nh SQL ??n gi?n ?? ki?m tra k?t n?i c�n s?ng hay kh�ng
# SELECT 1 l� c�u l?nh nh? nh?t, nhanh nh?t ?? ping Database
spring.datasource.hikari.connection-test-query=SELECT 1

# ??t t�n cho Pool ?? d? d�ng nh?n bi?t khi xem log ho?c debug
spring.datasource.hikari.pool-name=UserServiceHikariPool

# ============================================
# Tomcat Thread Pool (Web Server)
# ============================================
# S? l??ng lu?ng (Thread) t?i ?a ?? x? l� HTTP requests ??ng th?i
# 300 threads gi�p service ch?u ???c t?i trung b�nh kh� (Medium Traffic)
server.tomcat.threads.max=300

# S? l??ng lu?ng t?i thi?u lu�n ???c nu�i s?n
# Gi? 30 lu?ng ch? ?? ph?n h?i ngay l?p t?c khi c� kh�ch v�o
server.tomcat.threads.min-spare=30

# ?? d�i h�ng ??i (Queue) khi t?t c? c�c lu?ng ??u b?n
# N?u 300 threads ??u ?ang l�m vi?c, 500 request ti?p theo s? ???c x?p h�ng ch?
server.tomcat.accept-count=500

# T?ng s? l??ng k?t n?i TCP t?i ?a m� Server ch?p nh?n
# 5000 connections (bao g?m c? connections ?ang x? l� v� ?ang ch? keep-alive)
server.tomcat.max-connections=5000

# Th?i gian ch? c?a m?t k?t n?i (20 gi�y)
# N?u client k?t n?i m� kh�ng g?i request trong 20s, server s? ng?t k?t n?i
server.tomcat.connection-timeout=20000

# B?t t�nh n?ng n�n d? li?u ph?n h?i (Response Compression)
# Gi�p gi?m dung l??ng file g?i ?i, t?ng t?c ?? t?i cho ng??i d�ng
server.compression.enabled=true

# ??nh ngh?a c�c lo?i file (MIME types) s? ???c n�n
# N�n HTML, XML, Text, CSS, JS, JSON
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json

# K�ch th??c t?i thi?u ?? th?c hi?n n�n (1KB)
# Ch? n�n n?u d? li?u l?n h?n 1024 bytes (nh? qu� n�n s? t?n CPU m� kh�ng hi?u qu?)
server.compression.min-response-size=1024

# ============================================
# Spring Boot Actuator (Monitoring)
# ============================================
# M? c�c c?ng (endpoints) gi�m s�t c?n thi?t
# health (s?c kh?e), metrics (s? li?u), info (th�ng tin), prometheus (?? v? bi?u ??)
management.endpoints.web.exposure.include=health,metrics,info,prometheus

# Hi?n th? chi ti?t tr?ng th�i s?c kh?e
# "always" s? hi?n r�: Database UP/DOWN, Disk Space c�n bao nhi�u...
management.endpoint.health.show-details=always


# G?n nh�n t�n ?ng d?ng v�o d? li?u metrics
# Gi�p ph�n bi?t metrics c?a "User Service" v?i c�c service kh�c tr�n Grafana
management.metrics.tags.application=${spring.application.name}